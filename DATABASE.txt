USERS
SEX
BUSINESS_OWNERS
	DELIVERIES
BUSINESS
USERS_INFO
	TRANSACTIONS
	BATCH_OF_PRODUCTS
	CONSUMER
	TRANSACTION_STATUS
PRODUCTS
	BATCH_STATUS
PROVIDER
PRODUCT_TYPE
PROVIDERS_PRICE
PROVIDER_CONTACTS


CREATE TABLE USERS(
	ID SERIAL PRIMARY KEY NOT NULL, 
	LOGIN VARCHAR(50) UNIQUE NOT NULL, 
	PASS VARCHAR(100) NOT NULL
);

--DROP TABLE USERS CASCADE;

SELECT * FROM USERS;

INSERT INTO USERS(LOGIN, PASS) VALUES('TEST', 'QWERTY');

--------------------------------------------------------

CREATE TABLE SEX(
	ID SERIAL PRIMARY KEY NOT NULL,
	NAME VARCHAR(20) UNIQUE NOT NULL
);

INSERT INTO SEX(NAME) VALUES
	('Male'),
	('Female');
	
SELECT * FROM SEX;

--DROP TABLE SEX CASCADE;

CREATE TABLE USERS_INFO(
	ID INT UNIQUE NOT NULL, 
	FULLNAME VARCHAR(30),
	AGE INT,
	SEX INT,
	DATE_OF_BIRTH DATE,
	FOREIGN KEY (ID) REFERENCES USERS (ID),
	FOREIGN KEY (SEX) REFERENCES SEX (ID)
);

--DROP TABLE USERS_INFO CASCADE;

INSERT INTO USERS_INFO VALUES
(1, 'TEST NAME', 20, 1, '2020.10.15');

SELECT * FROM USERS_INFO;

SELECT FULLNAME, LOGIN, AGE, SEX.NAME AS SEX, DATE_OF_BIRTH AS "DATE OF BIRTH" FROM USERS_INFO, USERS, SEX 
WHERE 
	USERS_INFO.ID = USERS.ID AND SEX.ID = SEX;
	
-----------------------------------------------------------------------------------

CREATE TABLE BUSINESS_OWNERS(
	ID SERIAL PRIMARY KEY NOT NULL,
	USER_ID INT, 
	FINANCE INT,
	FOREIGN KEY (USER_ID) REFERENCES USERS (ID)
);

--DROP TABLE BUSINESS_OWNERS CASCADE;

CREATE TABLE BUSINESS(
	ID SERIAL PRIMARY KEY NOT NULL,
	NAME VARCHAR(100) UNIQUE NOT NULL,
	DESCRIPTION VARCHAR(500),
	START_DATE DATE,
	BALANCE INT,
	CAPITAL INT,
	CURRENT_OWNER INT,
	FOREIGN KEY (CURRENT_OWNER) REFERENCES USERS (ID)
);


--DROP TABLE BUSINESS CASCADE;

SELECT * FROM BUSINESS;

INSERT INTO BUSINESS(NAME, DESCRIPTION, START_DATE, BALANCE, CAPITAL, CURRENT_OWNER) 
VALUES
	('Kuding Detox', 'Detox tea', '2021.06.14', 100, 5000, 1),
	('Power', 'Power Capsule', '2021.06.14', 10, 100, 1);

SELECT NAME AS "BUSINESS NAME", BALANCE AS "BALANCE", CAPITAL AS "CAPITAL", START_DATE AS "START DATE", FULLNAME AS "OWNER" 
FROM BUSINESS, USERS, USERS_INFO 
	WHERE
		CURRENT_OWNER = USERS.ID AND USERS.ID = USERS_INFO.ID;



SELECT CURRENT_DATE ;

-----------------------------------------------------------------------------

CREATE TABLE PRODUCT_TYPE(
	ID SERIAL PRIMARY KEY NOT NULL,
	NAME VARCHAR(20)
);

--DROP TABLE PRODUCT_TYPE CASCADE;

SELECT * FROM PRODUCT_TYPE;

INSERT INTO PRODUCT_TYPE(NAME) VALUES('SPORT');

SELECT * FROM PG_CATALOG.PG_TABLES;

CREATE TABLE PRODUCTS(
	ID SERIAL PRIMARY KEY NOT NULL,
	NAME VARCHAR(50) UNIQUE NOT NULL,
	PRODUCT_TYPE INT,
	DESCRIPTION VARCHAR(200),
	FOREIGN KEY (PRODUCT_TYPE) REFERENCES PRODUCT_TYPE (ID)
);

--DROP TABLE PRODUCTS CASCADE;

SELECT * FROM PRODUCTS;

CREATE TABLE PROVIDER_CONTACTS(
	ID SERIAL PRIMARY KEY NOT NULL,
	FULLNAME VARCHAR(30),
	PHONE VARCHAR(15),
	CONTACTS VARCHAR(30),
	ADDRESS VARCHAR(100),
	UNIQUE(FULLNAME, PHONE, CONTACTS, ADDRESS)
);

--DROP TABLE PROVIDER_CONTACTS CASCADE;

SELECT * FROM PROVIDER_CONTACTS;

CREATE TABLE PROVIDER(
	ID SERIAL PRIMARY KEY NOT NULL,
	INFORMATION INT,
	PRODUCT INT,
	FOREIGN KEY (INFORMATION) REFERENCES PROVIDER_CONTACTS (ID),
	FOREIGN KEY (PRODUCT) REFERENCES PRODUCTS (ID),
	UNIQUE(INFORMATION, PRODUCT)
); 

--DROP TABLE PROVIDER CASCADE;

SELECT * FROM PROVIDER;

CREATE TABLE PROVIDERS_PRICE(
	ID SERIAL PRIMARY KEY NOT NULL,
	PROVIDER INT, 
	AMOUNT INT,
	PRICE INT,
	FOREIGN KEY (PROVIDER) REFERENCES PROVIDER (ID),
	UNIQUE(PROVIDER, AMOUNT, PRICE)
);

SELECT * FROM PROVIDERS_PRICE;

--DROP TABLE PROVIDERS_PRICE;





